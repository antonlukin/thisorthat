# То или Это: документация API

Все запросы к API должны быть выполнены через HTTPS и быть представлены в таком виде:

```
https://api.thisorthat.ru/<method_name>
```

Для всех запросов кроме `/register` поддерживаются HTTP методы **GET** и **POST**.  
Выбор HTTP метода ложится на плечи клиента, но стоит помнить, что запросы на изменение данных не должны кэшироваться.
- Все методы API не чувствительны к регистру
- Запросы должны выполняться с использованием кодировки UTF-8

Все методы кроме регистрации требуют обязательного параметра `token`, который клиент получает при регистрации.
При успешном вызове будет возвращен JSON-объект, содержащий результат.

## /register

Метод служит для регистрации клиента и получения токена авторизации.
Регистрацию следует выполнять только через **POST**.

#### Запрос

```
POST https://api.thisorthat.ru/register
```

#### Параметры
| Параметр | Маска | Описание |
|----------|--------------|----------|
| **client** | `^[a-z0-9-_]{0,16}$` | Название клиента, с которого выполняется авторизация. |
| **uniqid** | `^[a-z0-9-_]{0,64}$` | Уникальное для платформы значение, идентификатор пользователя или uuid. |
> Параметры, выделенные полужирным, являются обязательными

#### Ответ сервера

```json
{
    "ok": true,
    "result": {
        "token": "7:e2bc89a785aeb4784e7151ff52da707e"
    }
}
```

## /getItems

Возвращает список из **30** еще неотвеченных пользователем вопросов. Метод не возвращает отклоненные после модерации объекты.
> Этот метод может изменять поля базы данных

#### Запрос
```
GET|POST https://api.thisorthat.ru/getItems
```

#### Параметры запроса
| Название | Маска | Описание |
|----------|--------------|----------|
| **token** | `^\d:[a-z0-9{32}$` | Ключ авторизации, полученный при регистрации. |
| status    | `^(new\|approved)`  | **new** — получить вопросы, не прошедшие модерацию, <br>**approved** — для прошедших модерацию. По умолчанию вернутся оба типа вопросов. |

> Параметры, выделенные полужирным, являются обязательными

#### Ответ сервера

```json
{
    "ok": true,
    "result": {
        "items": {
            "6724": {
                "first_text": "Легче вскрыть на жопе вены",
                "last_text": "Легче дождаться перемены",
                "status": "new",
                "first_vote" :"2712",
                "last_vote": "12125"
            }
        }
    }
}
```

Ответ сервера содержит список объектов `items`, отсортированный и сгруппированный по ключу — id вопроса. Клиент может перемешать вопросы после получения.

#### Описание полей вопроса

| Поле | Описание |
|------|----------|
| first_text | Текст первого вопроса длинной 4-150 символов. |
| last_text | Текст последнего вопроса длинной 4-150 символов. |
| status | **new** — новый вопрос <br>**approved** — прошел модерацию. |
| first_vote | Количество ответов на первый вопрос. |
| last_vote | Количество ответов на последний вопрос. |


## /getMyItems
